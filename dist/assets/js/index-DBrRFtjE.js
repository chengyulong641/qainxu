import{r as e}from"./rquest-BdLykTFq.js";import{_ as l}from"./index-CD_ICcaK.js";import{b as a,a as o,B as u,S as t,L as n,P as s,I as c,c as i,E as d,F as r,f as m,g as v,T as p}from"./ui-vendor-B9LTyEOQ.js";import{r as y,e as k,E as f,G as h,j as g,x as V,L as w,I as _,Y as I,K as b,D as C}from"./vue-vendor-loiPTQO0.js";const S={class:"clock-in"},U={class:"info-content"},L={class:"info-top"},x={class:"clock-panel"},j={class:"time-display"},z={class:"clock-actions"},O={key:1,class:"task-list"},$={style:{display:"flex","align-items":"center","justify-content":"flex-end"}},q={class:"task-info"},D={key:2,class:"empty-state"},E={class:"config-container"},N={class:"top"},T={class:"form-actions"},B=l({__name:"index",setup(l){const B=y(!1),F=y(!1),G=y(!1),K=y(!0),P=y(!1),Y=y(null),A=y("clockIn"),H=y([]),J=y(localStorage.getItem("username")||""),M=e=>{"clockIn"===A.value?W.value.clockIn=e.selectedValues.join(":"):W.value.clockOut=e.selectedValues.join(":"),P.value=!1},Q=y({}),R=()=>{Q.value.id&&(W.value={...Q.value},G.value=!0),B.value=!0},W=y({username:"",password:"",clockIn:"09:00:00",clockOut:"18:00:00",email:"",noteLevel:1,delay:3}),X=()=>{W.value={username:"",password:"",clockIn:"09:00:00",clockOut:"18:00:00",email:"",noteLevel:1,delay:3}},Z=()=>{localStorage.removeItem("username"),Y.value=null,X(),Q.value={},location.reload()},ee=()=>{G.value=!1,Y.value=null,X(),B.value=!1},le=y(""),ae=y(""),oe=()=>{const e=new Date;le.value=e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),ae.value=e.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})},ue=async()=>{try{F.value=!0;const a=await(l=localStorage.getItem("username"),e({url:`/task/detail/${l}`,method:"get"}));Q.value=a||{},K.value=a.enable,Y.value=a.id||null}catch(o){a("获取任务列表失败")}finally{F.value=!1}var l},te=async l=>{try{F.value=!0,await function(l){return e({url:`/task/execute/${l}`,method:"post"})}(l),o("任务已开始执行"),ue()}catch(u){a("执行任务失败")}finally{F.value=!1}},ne=async l=>{try{F.value=!0,await function(l){return e({url:`/task/pause/${l}`,method:"post"})}(l),o("任务已暂停"),ue()}catch(u){a("暂停任务失败")}finally{F.value=!1}},se=async l=>{try{F.value=!0,await function(l){return e({url:`/task/resume/${l}`,method:"post"})}(l),o("任务已恢复"),ue()}catch(u){a("恢复任务失败")}finally{F.value=!1}},ce=async l=>{try{F.value=!0,await function(l){return e({url:`/task/delete/${l}`,method:"post"})}(l),o("任务已删除"),localStorage.removeItem("username"),ue()}catch(u){a("删除任务失败")}finally{F.value=!1}},ie=async()=>{try{F.value=!0,G.value&&Y.value?(await(l={id:Y.value,...W.value},e({url:"/task/modify",method:"post",data:l})),o("任务已更新")):(await function(l){return e({url:"/task/create",method:"post",data:l})}({...W.value}),localStorage.setItem("username",W.value.username),o("任务已创建")),X(),G.value=!1,Y.value=null,B.value=!1,ue()}catch(u){a("保存任务失败")}finally{F.value=!1}var l};return k(()=>{if(oe(),!localStorage.getItem("username")){let e=prompt("请输入您的名称","");e&&localStorage.setItem("username",e)}setInterval(oe,1e3),ue()}),(e,l)=>{const a=c,o=u,y=t,k=i,F=n,X=d,oe=r,ue=m,de=v,re=s,me=p;return C(),f("div",S,[h("div",U,[h("div",L,[h("span",null,[g(a,{name:"clock-o",size:"24",class:"clock-icon"}),l[17]||(l[17]=V(" 考勤打卡"))])]),Y.value||J.value?(C(),w(o,{key:0,type:"danger",onClick:Z,icon:"delete-o"},{default:_(()=>l[18]||(l[18]=[V(" 清空缓存 ")])),_:1})):I("",!0),h("div",x,[h("div",j,[h("h2",null,b(le.value),1),h("p",null,b(ae.value),1)]),h("div",z,[g(o,{type:"primary",size:"large",onClick:R,icon:"plus"},{default:_(()=>[V(b(Q.value.username?"修改任务":"创建任务"),1)]),_:1}),g(o,{type:"success",size:"large",onClick:l[0]||(l[0]=e=>te(Q.value.id)),icon:"clock"},{default:_(()=>l[19]||(l[19]=[V(" 手动执行 ")])),_:1})])]),Q.value.username?(C(),f("div",O,[h("h3",null,[h("div",null,[g(a,{name:"todo-list-o"}),l[20]||(l[20]=V(" 任务信息"))]),h("div",$,[g(y,{modelValue:K.value,"onUpdate:modelValue":l[1]||(l[1]=e=>K.value=e),onChange:l[2]||(l[2]=()=>K.value?se(Q.value.id):ne(Q.value.id)),size:"20",style:{"margin-right":"10px"}},null,8,["modelValue"]),g(o,{onClick:l[3]||(l[3]=e=>ce(Q.value.id)),size:"mini",type:"danger"},{default:_(()=>l[21]||(l[21]=[V("删除任务")])),_:1})])]),g(F,null,{default:_(()=>[g(k,{title:Q.value.username,class:"task-cell"},{label:_(()=>[h("div",q,[h("p",null,[g(a,{name:"sign"}),V(" 上班时间: "+b(Q.value.clockIn),1)]),h("p",null,[g(a,{name:"completed"}),V(" 下班时间: "+b(Q.value.clockOut),1)]),h("p",null,[g(a,{name:"envelop-o"}),V(" 邮箱: "+b(Q.value.email),1)]),h("p",null,[g(a,{name:"bell"}),V(" 提醒级别: "+b(Q.value.noteLevel),1)])])]),"right-icon":_(()=>l[22]||(l[22]=[])),_:1},8,["title"])]),_:1})])):(C(),f("div",D,[g(X,{image:"search",description:"暂无任务，请点击创建任务按钮开始"})]))]),g(re,{show:B.value,"onUpdate:show":l[13]||(l[13]=e=>B.value=e),position:"bottom",style:{height:"80%"},round:""},{default:_(()=>[h("div",E,[h("div",N,[h("span",null,b(G.value?"修改任务":"新增任务"),1),g(a,{name:"cross",onClick:ee})]),g(de,{onSubmit:ie},{default:_(()=>[g(oe,{modelValue:W.value.username,"onUpdate:modelValue":l[4]||(l[4]=e=>W.value.username=e),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}]},{"left-icon":_(()=>[g(a,{name:"user-o"})]),_:1},8,["modelValue"]),g(oe,{modelValue:W.value.password,"onUpdate:modelValue":l[5]||(l[5]=e=>W.value.password=e),name:"password",label:"密码",type:"password",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},{"left-icon":_(()=>[g(a,{name:"lock"})]),_:1},8,["modelValue"]),g(oe,{label:"上班时间",modelValue:W.value.clockIn,"onUpdate:modelValue":l[6]||(l[6]=e=>W.value.clockIn=e),onClick:l[7]||(l[7]=e=>(P.value=!0,A.value="clockIn")),readonly:""},{"left-icon":_(()=>[g(a,{name:"sign"})]),"right-icon":_(()=>[g(a,{name:"arrow"})]),_:1},8,["modelValue"]),g(oe,{label:"下班时间",modelValue:W.value.clockOut,"onUpdate:modelValue":l[8]||(l[8]=e=>W.value.clockOut=e),onClick:l[9]||(l[9]=e=>(P.value=!0,A.value="clockOut")),readonly:""},{"left-icon":_(()=>[g(a,{name:"completed"})]),"right-icon":_(()=>[g(a,{name:"arrow"})]),_:1},8,["modelValue"]),g(oe,{modelValue:W.value.delay,"onUpdate:modelValue":l[10]||(l[10]=e=>W.value.delay=e),type:"digit",label:"延迟范围",placeholder:"延迟范围(分钟，目标时间往后延迟)"},{"left-icon":_(()=>[g(a,{name:"clock-o"})]),_:1},8,["modelValue"]),g(oe,{modelValue:W.value.email,"onUpdate:modelValue":l[11]||(l[11]=e=>W.value.email=e),name:"email",label:"邮箱",placeholder:"请输入邮箱地址",rules:[{required:!0,message:"请填写邮箱"},{pattern:/.+@.+\..+/,message:"请输入有效的邮箱地址"}]},{"left-icon":_(()=>[g(a,{name:"envelop-o"})]),_:1},8,["modelValue"]),g(oe,{name:"noteLevel",label:"提醒级别"},{"left-icon":_(()=>[g(a,{name:"bell"})]),input:_(()=>[g(ue,{modelValue:W.value.noteLevel,"onUpdate:modelValue":l[12]||(l[12]=e=>W.value.noteLevel=e),min:"1",max:"5",theme:"round"},null,8,["modelValue"])]),_:1}),h("div",T,[g(o,{round:"",block:"",type:"primary","native-type":"submit"},{default:_(()=>[V(b(G.value?"保存修改":"创建任务"),1)]),_:1})])]),_:1})])]),_:1},8,["show"]),g(re,{show:P.value,"onUpdate:show":l[16]||(l[16]=e=>P.value=e),position:"bottom",round:"",style:{height:"40%"}},{default:_(()=>[g(me,{modelValue:H.value,"onUpdate:modelValue":l[14]||(l[14]=e=>H.value=e),title:"选择时间",onConfirm:M,onCancel:l[15]||(l[15]=e=>P.value=!1),"columns-type":["hour","minute","second"]},null,8,["modelValue"])]),_:1},8,["show"])])}}},[["__scopeId","data-v-76f2254c"]]);export{B as default};
