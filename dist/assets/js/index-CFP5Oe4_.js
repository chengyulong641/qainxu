import{r as a,o as e,e as l,E as s,j as t,u as d,I as i,D as v,G as r,H as c,V as u,Y as o,K as h,B as m,J as n}from"./vue-vendor-loiPTQO0.js";import{d as g,e as b}from"./vehicle-CobAlhmz.js";import{u as y}from"./api-polling-K83He-72.js";import{_ as p}from"./index-CD_ICcaK.js";import{N as f,i as w,b as C,h as S,I as k}from"./ui-vendor-B9LTyEOQ.js";import"./rquest-BdLykTFq.js";import"./user-nHm_wyER.js";const x={class:"battery-detail-page"},M={class:"content"},T={class:"battery-card"},V={class:"battery-status"},j={class:"battery-body"},U={key:0,class:"battery-wave"},_={class:"battery-info"},I={class:"battery-percentage"},N={key:0,class:"full-charge-info"},W={class:"detail-card"},R={class:"data-grid"},q={class:"data-item"},L={class:"data-value"},A={class:"data-item"},B={class:"data-value"},D={key:0,class:"data-item"},E={class:"data-value"},G={key:1,class:"data-item"},H={class:"data-value"},J={class:"data-item"},K={class:"data-value"},P={key:2,class:"data-item"},Y={class:"data-value"},$={key:3,class:"data-item"},z={class:"data-value"},F={class:"data-item"},O={class:"detail-card"},Q={class:"data-grid"},X={class:"data-item"},Z={class:"data-value"},aa={class:"data-item"},ea={class:"data-value"},la={class:"data-item"},sa={class:"data-value"},ta={class:"data-item"},da={class:"data-value"},ia={key:0,class:"detail-card"},va={class:"max-mileage"},ra={class:"refresh-time"},ca=p({__name:"index",setup(p){const ca=m(),ua=n(),oa=a(!1),ha=a({chargeState:"",bmssoc:"0",hmiRidableMile:"0",powerUseToday:"0",powerChargeMonth:"0",powerUseMonth:"0",chargeCount:"0",score:"良好",bmsVoltage:"0",batteryTemp:null,soh:null,batteryLevel:"0",whetherChargeState:!1,chargeStateStr:"未充电",maxMileage:null,refreshTime:""}),ma=a({chargeState:"0",bmsCurrent:"0",bmsVoltage:"0",power:"0.0",fullChargeTime:"0.0",fullChargeTimeUnitMinute:"0"}),na=a=>{const e=Number(a);return e<=20?"level-low":e<=50?"level-medium":"level-high"},ga=async()=>{const a=ua.query.vinNo;if(a)try{const[e,l]=await Promise.all([g(a),b(a)]);"10000"===e.code&&e.data&&(ha.value=e.data),"10000"===l.code&&l.data&&(ma.value=l.data)}catch(e){C(e.message||"获取电池信息失败")}finally{S()}else C("缺少车辆信息")},ba=async()=>{try{await ga()}finally{oa.value=!1}},{start:ya,stop:pa,executeNow:fa,updateInterval:wa,setup:Ca}=y(ga,6e3,!1);return e(()=>{pa()}),l(()=>{ya()}),(a,e)=>{const l=f,m=k,n=w;return v(),s("div",x,[t(l,{title:"电池详情","left-arrow":"",onClickLeft:e[0]||(e[0]=a=>d(ca).back()),fixed:""}),t(n,{modelValue:oa.value,"onUpdate:modelValue":e[1]||(e[1]=a=>oa.value=a),onRefresh:ba,"success-text":"刷新成功",class:"full-height"},{default:i(()=>[r("div",M,[r("div",T,[r("div",V,[r("div",{class:c(["battery-icon",{charging:ha.value.whetherChargeState||"1"===ma.value.chargeState}])},[r("div",j,[r("div",{class:c(["battery-level",na(ha.value.bmssoc)]),style:u({height:`${ha.value.bmssoc||"0"}%`})},[ha.value.whetherChargeState||"1"===ma.value.chargeState?(v(),s("div",U)):o("",!0)],6)]),e[2]||(e[2]=r("div",{class:"battery-tip"},null,-1))],2),r("div",_,[r("div",I,h(ha.value.bmssoc||"0")+"%",1),r("div",{class:c(["battery-status-text",{"charging-text":ha.value.whetherChargeState||"1"===ma.value.chargeState}])},h(ha.value.chargeStateStr||("1"===ma.value.chargeState?"充电中":"未充电")),3),ha.value.whetherChargeState||"1"===ma.value.chargeState?(v(),s("div",N,[t(m,{name:"underway-o"}),r("span",null,"预计"+h(ma.value.fullChargeTime||"0.0")+"小时"+h(ma.value.fullChargeTimeUnitMinute||"0")+"分钟充满",1)])):o("",!0)])])]),r("div",W,[e[11]||(e[11]=r("div",{class:"card-title"},"电池数据",-1)),r("div",R,[r("div",q,[e[3]||(e[3]=r("div",{class:"data-label"},"剩余电量",-1)),r("div",L,h(ha.value.bmssoc||"0")+"%",1)]),r("div",A,[e[4]||(e[4]=r("div",{class:"data-label"},"剩余里程",-1)),r("div",B,h(ha.value.hmiRidableMile||"0")+"km",1)]),ha.value.soh?(v(),s("div",D,[e[5]||(e[5]=r("div",{class:"data-label"},"电池健康度",-1)),r("div",E,h(ha.value.soh)+"%",1)])):o("",!0),ha.value.batteryTemp?(v(),s("div",G,[e[6]||(e[6]=r("div",{class:"data-label"},"电池温度",-1)),r("div",H,h(ha.value.batteryTemp)+"°C",1)])):o("",!0),r("div",J,[e[7]||(e[7]=r("div",{class:"data-label"},"当前电压",-1)),r("div",K,h(ha.value.bmsVoltage||ma.value.bmsVoltage||"0")+"V",1)]),(ha.value.whetherChargeState||"1"===ma.value.chargeState)&&ma.value.bmsCurrent?(v(),s("div",P,[e[8]||(e[8]=r("div",{class:"data-label"},"当前电流",-1)),r("div",Y,h(ma.value.bmsCurrent||"0")+"A",1)])):o("",!0),(ha.value.whetherChargeState||"1"===ma.value.chargeState)&&ma.value.power?(v(),s("div",$,[e[9]||(e[9]=r("div",{class:"data-label"},"充电功率",-1)),r("div",z,h(ma.value.power||"0.0")+"kW",1)])):o("",!0),r("div",F,[e[10]||(e[10]=r("div",{class:"data-label"},"电池评分",-1)),r("div",{class:c(["data-value",{"score-good":"优"===ha.value.score}])},h(ha.value.score||"良好"),3)])])]),r("div",O,[e[16]||(e[16]=r("div",{class:"card-title"},"用电统计",-1)),r("div",Q,[r("div",X,[e[12]||(e[12]=r("div",{class:"data-label"},"今日用电",-1)),r("div",Z,h(ha.value.powerUseToday||"0")+"kWh",1)]),r("div",aa,[e[13]||(e[13]=r("div",{class:"data-label"},"本月用电",-1)),r("div",ea,h(ha.value.powerUseMonth||"0")+"kWh",1)]),r("div",la,[e[14]||(e[14]=r("div",{class:"data-label"},"本月充电",-1)),r("div",sa,h(ha.value.powerChargeMonth||"0")+"kWh",1)]),r("div",ta,[e[15]||(e[15]=r("div",{class:"data-label"},"充电次数",-1)),r("div",da,h(ha.value.chargeCount||"0")+"次",1)])])]),ha.value.maxMileage?(v(),s("div",ia,[e[17]||(e[17]=r("div",{class:"card-title"},"最大续航",-1)),r("div",va,[t(m,{name:"flag-o"}),r("span",null,h(ha.value.maxMileage)+"km",1)])])):o("",!0),r("div",ra," 数据更新时间: "+h(ha.value.refreshTime||"未知"),1)])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-69f9b7ff"]]);export{ca as default};
