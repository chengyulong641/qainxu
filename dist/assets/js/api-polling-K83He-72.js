import{a as t}from"./index-CD_ICcaK.js";class s{constructor(t,s,n=null,i=null){this.apiFunction=t,this.interval=s,this.onSuccess=n,this.onError=i,this.timerId=null,this.isPolling=!1}start(t=!0){if(this.isPolling)return this;this.isPolling=!0;const s=()=>{this.isPolling&&this.apiFunction().then(t=>{this.onSuccess&&this.onSuccess(t)}).catch(t=>{this.onError&&this.onError(t)}).finally(()=>{this.isPolling&&(this.timerId=setTimeout(s,this.interval))})};return t?s():this.timerId=setTimeout(s,this.interval),this}stop(){return this.isPolling=!1,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this}updateInterval(t){return this.interval=t,this.isPolling&&this.stop().start(!1),this}executeNow(){return this.apiFunction().then(t=>(this.onSuccess&&this.onSuccess(t),t)).catch(t=>{throw this.onError&&this.onError(t),t})}destroy(){this.stop(),this.apiFunction=null,this.onSuccess=null,this.onError=null}}const n=(n,i,e=!0)=>{const r=new s(n,i);let o=!1;return{start:(t=!0)=>r.start(t),stop:()=>r.stop(),executeNow:()=>r.executeNow(),updateInterval:t=>r.updateInterval(t),destroy:()=>r.destroy(),setup:(s,n)=>{o||(o=!0,r.onSuccess=s,r.onError=n,e&&r.start(),"undefined"!=typeof window&&t(async()=>{const{onBeforeUnmount:t,getCurrentInstance:s}=await import("./vue-vendor-loiPTQO0.js").then(t=>t.a3);return{onBeforeUnmount:t,getCurrentInstance:s}},[]).then(({onBeforeUnmount:t,getCurrentInstance:s})=>{s()&&t(()=>{r.destroy()})}).catch(()=>{}))}}};export{n as u};
